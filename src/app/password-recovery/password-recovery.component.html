<div class="password-recovery-container">
  <div *ngIf="step === 'email'" class="step">
    <h2>Inserisci l'email per il recupero password</h2>
    <form [formGroup]="recoveryForm" (ngSubmit)="sendRecoveryEmail()">
      <div class="form-field">
        <label>Email</label>
        <input type="email" formControlName="email" required>
        <div *ngIf="recoveryForm.get('email')?.invalid && (recoveryForm.get('email')?.dirty || recoveryForm.get('email')?.touched)">
          <mat-error *ngIf="recoveryForm.get('email')?.hasError('required')">Email richiesta</mat-error>
          <mat-error *ngIf="recoveryForm.get('email')?.hasError('email')">Email non valida</mat-error>
        </div>
      </div>
      <button mat-raised-button color="primary" type="submit" [disabled]="recoveryForm.invalid">Invia Email di Recupero</button>
    </form>
  </div>
  <div *ngIf="step === 'code'" class="step">
    <h2>Inserisci il codice di conferma</h2>
    <form [formGroup]="codeConfirmationForm" (ngSubmit)="confirmCode()">
      <div class="form-field">
        <label>Codice di conferma</label>
        <input type="text" formControlName="code" required>
        <div *ngIf="codeConfirmationForm.get('code')?.invalid && (codeConfirmationForm.get('code')?.dirty || codeConfirmationForm.get('code')?.touched)">
          <mat-error *ngIf="codeConfirmationForm.get('code')?.hasError('required')">Codice richiesto</mat-error>
        </div>
      </div>
      <button mat-raised-button color="primary" type="submit" [disabled]="codeConfirmationForm.invalid">Conferma Codice</button>
    </form>
  </div>
  <div *ngIf="step === 'password'" class="step">
    <h2>Crea una nuova password</h2>
    <form [formGroup]="newPasswordForm" (ngSubmit)="createNewPassword()">
      <div class="form-field">
        <label>Nuova Password</label>
        <input type="password" formControlName="password" required>
        <div *ngIf="newPasswordForm.get('password')?.invalid && (newPasswordForm.get('password')?.dirty || newPasswordForm.get('password')?.touched)">
          <mat-error *ngIf="newPasswordForm.get('password')?.hasError('required')">Password richiesta</mat-error>
          <mat-error *ngIf="newPasswordForm.get('password')?.hasError('minlength')">La password deve essere di almeno 6 caratteri</mat-error>
        </div>
      </div>
      <div class="form-field">
        <label>Conferma Password</label>
        <input type="password" formControlName="confirmPassword" required>
        <div *ngIf="newPasswordForm.get('confirmPassword')?.invalid && (newPasswordForm.get('confirmPassword')?.dirty || newPasswordForm.get('confirmPassword')?.touched)">
          <mat-error *ngIf="newPasswordForm.get('confirmPassword')?.hasError('required')">Conferma password richiesta</mat-error>
          <mat-error *ngIf="newPasswordForm.hasError('passwordMismatch')">Le password non corrispondono</mat-error>
        </div>
      </div>
      <button mat-raised-button color="primary" type="submit" [disabled]="newPasswordForm.invalid">Crea Nuova Password</button>
    </form>
  </div>
</div>
